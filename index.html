<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI ê¸°ë°˜ ë‚ ì”¨ë³„ ì˜· ì¶”ì²œ</title>
    <style>
        /* CSS ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .input-group label {
            width: 120px; /* ë¼ë²¨ ë„ˆë¹„ ê³ ì • */
            font-weight: 600;
            color: #2c3e50;
        }

        .input-group input, .input-group select {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus, .input-group select:focus {
            border-color: #3498db;
            outline: none;
        }

        .action-area {
            display: flex;
            justify-content: flex-end;
            margin-top: 25px;
        }

        button {
            background-color: #3498db;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        button:hover {
            background-color: #2980b9;
        }

        button:active {
            transform: scale(0.98);
        }

        #result-area {
            margin-top: 30px;
            padding: 20px;
            border: 1px dashed #3498db;
            border-radius: 8px;
            min-height: 100px;
            background-color: #ecf0f1;
            white-space: pre-wrap;
        }

        #result-area h3 {
            margin-top: 0;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ¨ MBTI & ë‚ ì”¨ ì˜· ì¶”ì²œ ì…ë ¥</h1>
        
        <div class="input-group">
            <label for="mbti">MBTI:</label>
            <input type="text" id="mbti" placeholder="ì˜ˆ: INFP, ESTJ" maxlength="4">
        </div>

        <div class="input-group">
            <label for="gender">ì„±ë³„:</label>
            <select id="gender">
                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="male">ë‚¨ì„±</option>
                <option value="female">ì—¬ì„±</option>
            </select>
        </div>

        <div class="input-group">
            <label for="weather">ë‚ ì”¨:</label>
            <input type="text" id="weather" placeholder="ì˜ˆ: ë§‘ìŒ, ë¹„, ëˆˆ">
        </div>

        <div class="input-group">
            <label for="temp-max">ìµœê³  ê¸°ì˜¨ (â„ƒ):</label>
            <input type="number" id="temp-max" placeholder="ì˜ˆ: 28">
        </div>

        <div class="input-group">
            <label for="temp-min">ìµœì € ê¸°ì˜¨ (â„ƒ):</label>
            <input type="number" id="temp-min" placeholder="ì˜ˆ: 15">
        </div>

        <div class="input-group">
            <label for="style">í‰ì†Œ ìŠ¤íƒ€ì¼:</label>
            <input type="text" id="style" placeholder="ì˜ˆ: ìºì£¼ì–¼, ë¯¸ë‹ˆë©€, ìŠ¤íŠ¸ë¦¿">
        </div>

        <div class="action-area">
            <button onclick="register()">ì˜· ì¶”ì²œë°›ê¸°</button>
        </div>
        
    </div>

    <div class="container" style="margin-top: 20px;">
        <div id="result-area">
            <h3>ğŸ’Œ ì¶”ì²œ ê²°ê³¼</h3>
            ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
        </div>
    </div>

    <script>
        // JavaScript ë¡œì§

        /**
         * âš ï¸ API ì„œë²„ì˜ ì£¼ì†Œë¥¼ ë‹´ëŠ” ìƒìˆ˜
         * í˜„ì¬ëŠ” ë¹ˆ ë¬¸ìì—´ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ í†µì‹  ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
         * ë°±ì—”ë“œ ì„œë²„ ì£¼ì†Œë¥¼ ì´ê³³ì— ì…ë ¥í•˜ì—¬ ì—°ê²°í•˜ì‹­ì‹œì˜¤.
         */
        const SERVER_URL = "https://37f81b4a-14ad-4e36-8378-e8697db2c00f-00-28jqdlsfizo1a.pike.replit.dev/generate_minutes"; 
    

        /**
         * ì…ë ¥ í•„ë“œì˜ ë°ì´í„°ë¥¼ ëª¨ì•„ ì„œë²„ì— ì „ì†¡í•˜ê³  ê²°ê³¼ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * ìš”ì²­í•˜ì‹  fetch í•¨ìˆ˜ êµ¬ì¡°(method: 'POST', JSON.stringify)ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
         */
        async function register() {
            const resultArea = document.getElementById('result-area');
            resultArea.innerHTML = "<h3>ğŸ’Œ ì¶”ì²œ ê²°ê³¼</h3>ì„œë²„ì— ìš”ì²­ ì¤‘ì…ë‹ˆë‹¤...";

            // 1. ì…ë ¥ í•„ë“œì—ì„œ ë°ì´í„° ìˆ˜ì§‘
            const mbti = document.getElementById('mbti').value.toUpperCase();
            const gender = document.getElementById('gender').value;
            const weather = document.getElementById('weather').value;
            const tempMax = document.getElementById('temp-max').value;
            const tempMin = document.getElementById('temp-min').value;
            const style = document.getElementById('style').value;

            // 2. ì…ë ¥ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ (ê°„ë‹¨í•œ ì˜ˆì‹œ)
            if (!mbti || !gender || !weather || !tempMax || !tempMin || !style) {
                resultArea.innerHTML = "<h3>ğŸ’Œ ì¶”ì²œ ê²°ê³¼</h3>âš ï¸ ëª¨ë“  ì…ë ¥ í•„ë“œë¥¼ ì±„ì›Œì£¼ì„¸ìš”.";
                return;
            }

            // 3. ì„œë²„ì— ì „ì†¡í•  ë°ì´í„° ê°ì²´ ìƒì„±
            const requestData = {
                mbti: mbti,
                gender: gender,
                weather: weather,
                temp_max: parseFloat(tempMax), // ìˆ«ìë¡œ ë³€í™˜
                temp_min: parseFloat(tempMin), // ìˆ«ìë¡œ ë³€í™˜
                style: style
            };

            // 4. fetch í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ì„œë²„ í†µì‹  (ìš”ì²­ êµ¬ì¡° ì¤€ìˆ˜)
            try {
                if (SERVER_URL === "") {
                     throw new Error("SERVER_URLì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. ë°±ì—”ë“œ ì£¼ì†Œë¥¼ ì„¤ì •í•´ì•¼ í†µì‹ ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
                }

                const response = await fetch(SERVER_URL, {
                    method: 'POST', // í†µì‹  ë°©ì‹: method: 'POST'
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    // JSON ë°ì´í„°: ì…ë ¥ í•„ë“œì˜ ë°ì´í„°ë¥¼ ëª¨ì•„ JSON í˜•íƒœë¡œ ì„œë²„ì— ì „ì†¡
                    body: JSON.stringify(requestData) 
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                
                // 5. ì„œë²„ë¡œë¶€í„° ë°›ì€ ì¶”ì²œ ê²°ê³¼ë¥¼ í™”ë©´ì— í‘œì‹œ
                resultArea.innerHTML = `
                    <h3>âœ… ì¶”ì²œ ê²°ê³¼</h3>
                    <p><strong>MBTI:</strong> ${result.mbti}</p>
                    <p><strong>ë‚ ì”¨:</strong> ${result.weather} (ìµœê³  ${result.temp_max}Â°C / ìµœì € ${result.temp_min}Â°C)</p>
                    <hr>
                    <p style="font-size: 1.1em; color: #e74c3c;"><strong>ì˜¤ëŠ˜ì˜ ì¶”ì²œ ì½”ë””:</strong></p>
                    <p style="font-weight: bold;">${result.recommendation || "ì¶”ì²œ ì •ë³´ë¥¼ ë°›ì•„ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."}</p>
                `;

            } catch (error) {
                // 6. í†µì‹  ì˜¤ë¥˜ ì²˜ë¦¬ (í˜„ì¬ëŠ” SERVER_URLì´ ë¹„ì–´ìˆì–´ ì´ ë¸”ë¡ì´ ì‹¤í–‰ë¨)
                console.error("Fetch Error:", error);

                // ì„œë²„ í†µì‹ ì´ ì„±ê³µí–ˆì„ ë•Œ ë°›ì„ ì‘ë‹µ ë°ì´í„°ì˜ êµ¬ì¡°ë¥¼ ê°€ì •í•˜ì—¬ ë¯¸ë¦¬ ì¶œë ¥í•©ë‹ˆë‹¤.
                const mockResponse = {
                    mbti: mbti,
                    weather: weather,
                    temp_max: tempMax,
                    temp_min: tempMin,
                    recommendation: `[í†µì‹  ì˜¤ë¥˜] ì„œë²„ ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤. (ì—ëŸ¬: ${error.message})\n\n[ì˜ˆìƒ ì‘ë‹µ]: ${mbti}ì˜ ${gender}ì¸ ë‹¹ì‹ ì—ê²ŒëŠ” ${tempMin}Â°C ~ ${tempMax}Â°C ë‚ ì”¨ì— ${style} ìŠ¤íƒ€ì¼ì„ ê³ ë ¤í•˜ì—¬ 'ê°€ë²¼ìš´ ë‹ˆíŠ¸, íŠ¸ë Œì¹˜ ì½”íŠ¸, ê·¸ë¦¬ê³  ë°ë‹˜ íŒ¬ì¸ 'ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.`
                };

                resultArea.innerHTML = `
                    <h3>âŒ í†µì‹  ì˜¤ë¥˜ ë°œìƒ</h3>
                    <p style="color: #e74c3c; font-weight: bold;">${error.message}</p>
                    <hr>
                    <p style="font-weight: bold;">[ë°ì´í„° ì „ì†¡ ì„±ê³µ í™•ì¸]</p>
                    <p>ì„œë²„ë¡œ ì „ì†¡í•˜ë ¤ë˜ ë°ì´í„°: ${JSON.stringify(requestData, null, 2)}</p>
                    <hr>
                    <p style="font-weight: bold;">[ì„ì‹œ ì¶”ì²œ ê²°ê³¼ (í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸)]</p>
                    <pre style="background-color: #f0f0f0; padding: 10px; border-radius: 5px;">${mockResponse.recommendation}</pre>
                `;
            }
        }
    </script>
</body>

</html>
